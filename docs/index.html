<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Milestones</title>
  <style>
    body { font-family: -apple-system, Arial, sans-serif; margin: 2em; background: #f9f9f9; }
    h1 { text-align: center; }
    table { border-collapse: collapse; margin: 1em auto; min-width: 80%; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    th, td { border: 1px solid #ccc; padding: 12px; text-align: center; }
    th { background: #f0f0f0; }
    tr:hover { background: #f9f9ff; }
    caption { caption-side: bottom; font-size: 0.9em; color: #555; margin-top: 10px; }
    .controls { text-align: center; margin-bottom: 1em; }
    button { padding: 8px 14px; margin: 0 5px; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #eee; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>üìÖ My Milestones</h1>

  <div class="controls">
    <button onclick="setMode('full')">Full Mode</button>
    <button onclick="setMode('countdown')">Countdown Only</button>
  </div>

  <table id="milestone-table">
    <tr>
      <th>Event</th>
      <th>Date</th>
      <th class="since-col">Days Since</th>
      <th class="until-col">Days Until</th>
    </tr>
    <!-- üîΩ Replace these rows with your own events -->
    <tr data-date="2018-10-02">
      <td>I Am Tattoo</td>
      <td>2018-10-02</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2019-11-09">
      <td>Cian betrays and rejects me</td>
      <td>2019-11-09</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2022-10-14">
      <td>Alpha/Omega Tattoo</td>
      <td>2022-10-14</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2023-01-16">
      <td>Last time with my 4 dids</td>
      <td>2023-01-16</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2023-02-02">
      <td>Rae's Attempted Suicide</td>
      <td>2023-02-02</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2024-05-11">
      <td>Last I saw Stina</td>
      <td>2024-05-11</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2024-07-05">
      <td>NRG layoff</td>
      <td>2024-07-05</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2024-07-24">
      <td>Last I saw Rae</td>
      <td>2024-07-24</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2024-09-28">
      <td>Rae denies me her address</td>
      <td>2024-09-28</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2024-10-075">
      <td>Boot camp began</td>
      <td>2024-10-07</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2025-09-06">
      <td>Last text with Rae</td>
      <td>2025-09-06</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2024-12-21">
      <td>Robin's 1st kiss</td>
      <td>2024-12-21</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2025-03-30">
      <td>1st Robin & I partook</td>
      <td>2025-03-30</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2025-05-23">
      <td>Grant's average behavior</td>
      <td>2025-05-23</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2025-08-11">
      <td>Began Minoxidil</td>
      <td>2025-08-11</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <tr data-date="2025-10-01">
      <td>Call Domestic Relations</td>
      <td>2025-10-01</td>
      <td class="since-col"></td>
      <td class="until-col"></td>
    </tr>
    <!-- üîº Add/remove rows as needed -->
  </table>

  <caption>Today is <span id="today"></span></caption>

<script>
  const today = new Date();
  document.getElementById("today").textContent = today.toDateString();

  let currentMode = "full"; // default

  function updateTable() {
    const rows = Array.from(document.querySelectorAll("tr[data-date]"));

    // calculate deltas
    rows.forEach(row => {
      const target = new Date(row.dataset.date);
      const diff = Math.floor((today - target) / (1000 * 60 * 60 * 24));
	  row.querySelector(".since-col").textContent = diff >= 0 ? diff.toLocaleString() : "-";
      row.querySelector(".until-col").textContent = diff < 0 ? Math.abs(diff).toLocaleString() : "-";

      row.dataset.diff = diff; // store for sorting
    });

    // remove any old Today marker
    document.querySelectorAll(".today-marker").forEach(el => el.remove());

    // sort rows
    const tbody = document.querySelector("table").tBodies[0];
    rows
      .sort((a, b) => {
        const diffA = parseInt(a.dataset.diff, 10);
        const diffB = parseInt(b.dataset.diff, 10);

        if (currentMode === "countdown") {
          // future events first
          if (diffA < 0 && diffB < 0) {
            return diffA - diffB; // both future
          }
          if (diffA < 0) return -1; // A is future, B is past
          if (diffB < 0) return 1;  // B is future, A is past
          return diffA - diffB;     // both past
        } else {
          // full mode chronological
          return new Date(a.dataset.date) - new Date(b.dataset.date);
        }
      })
      .forEach(row => tbody.appendChild(row));

    // insert Today marker row
    const markerRow = document.createElement("tr");
    markerRow.classList.add("today-marker");
    markerRow.innerHTML = `
      <td colspan="4" style="background:#fffae6; text-align:center; font-weight:bold;">
        ‚¨áÔ∏è Today (${today.toDateString()}) ‚¨áÔ∏è
      </td>
    `;

    // find the first past event (diff >= 0) in countdown mode, or just the right place in full mode
    let inserted = false;
    for (let row of tbody.querySelectorAll("tr[data-date]")) {
      const diff = parseInt(row.dataset.diff, 10);
      if (diff >= 0) { // event is today or in the past
        tbody.insertBefore(markerRow, row);
        inserted = true;
        break;
      }
    }
    if (!inserted) {
      tbody.appendChild(markerRow); // if all events are future, marker goes at bottom
    }
  }

  function setMode(mode) {
    currentMode = mode; // remember mode
    const sinceCols = document.querySelectorAll(".since-col, th.since-col");
    if (mode === "countdown") {
      sinceCols.forEach(el => el.classList.add("hidden"));
    } else {
      sinceCols.forEach(el => el.classList.remove("hidden"));
    }
    updateTable(); // re-run sort
  }

  // run once on load
  updateTable();
</script>

</body>
</html>
